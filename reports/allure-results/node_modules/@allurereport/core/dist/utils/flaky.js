const MAX_LAST_HISTORY_SIZE = 5;
const badStatuses = ["failed", "broken"];
const isAllureClassicFlaky = (tr, history) => {
    if (history.length === 0 || !badStatuses.includes(tr.status)) {
        return false;
    }
    const limitedLastHistory = history.slice(0, MAX_LAST_HISTORY_SIZE);
    const limitedLastHistoryStatuses = limitedLastHistory.map((h) => h.status);
    return (limitedLastHistoryStatuses.includes("passed") &&
        limitedLastHistoryStatuses.indexOf("passed") < limitedLastHistoryStatuses.lastIndexOf("failed"));
};
export const isFlaky = (tr, history) => tr.flaky || isAllureClassicFlaky(tr, history);
